cd ~/blackduck-certs
cat > server-config.cnf << 'EOF'
[req]
distinguished_name = req_distinguished_name
req_extensions = v3_req
prompt = no

[req_distinguished_name]
C = US
ST = California
L = Mountain View
O = Blackduck Software Inc.
OU = Black Duck
CN = blackduck-server-internal

[v3_req]
basicConstraints = CA:FALSE
keyUsage = nonRepudiation, digitalSignature, keyEncipherment
extendedKeyUsage = serverAuth, clientAuth
subjectAltName = @alt_names

[alt_names]
DNS.1 = localhost
DNS.2 = hub.local
IP.1 = 127.0.0.1
EOF


openssl req -text -noout -verify -config server-config.cnf

openssl req -new -key server-key.pem -out server.csr -config server-config.cnf
openssl x509 -req -in server.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out server.pem -days 15 -sha256 -extfile server-config.cnf -extensions v3_req
rm server.csr  # Cleanup


openssl x509 -in server.pem -text -noout | grep -E "Not After|Issuer:|Subject Alternative Name"
openssl verify -CAfile ca.pem server.pem  # Should say "server.pem: OK"



